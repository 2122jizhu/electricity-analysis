<!DOCTYPE html>
<html style="height: 100%">
<head>
    <meta charset="utf-8">
    <title>2021年全球电力净消费量 Top 10</title>
    <!-- 引入 ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body style="height: 100%; margin: 0">
<!-- 图表容器 -->
<div id="container" style="height: 100%"></div>

<script type="text/javascript">
    var dom = document.getElementById("container");
    var myChart = echarts.init(dom);
    var app = {};

    // 1. 模拟 Spark 任务输出的 JSON 数据
    // 原始数据数值是“十亿千瓦时”为量级
    var rawData = [
        {"Country":"China","2021":7805.656341},
        {"Country":"United States","2021":3979.279761},
        {"Country":"India","2021":1442.750051},
        {"Country":"Russia","2021":996.4429162},
        {"Country":"Japan","2021":913.0781497},
        {"Country":"Brazil","2021":577.2953567},
        {"Country":"South Korea","2021":567.6724331},
        {"Country":"Canada","2021":554.7443874},
        {"Country":"Germany","2021":511.6603884},
        {"Country":"France","2021":447.4470538}
    ];

    // 2. 数据分离
    var countries = rawData.map(function(item) { return item.Country; });
    var values = rawData.map(function(item) { return item["2021"]; });

    var option = {
        // [修改点1] 标题设置：在副标题中全局声明单位
        title: {
            text: '2021年数据集电力净消费量 Top 10',
            subtext: '单位：十亿千瓦时 (Billion kWh) | 来源: Spark Analysis Task 1',
            left: 'center',
            textStyle: {
                fontSize: 24,
                color: '#333'
            },
            subtextStyle: {
                fontSize: 14,
                color: '#666'
            }
        },
        // [修改点2] 提示框：悬停时显示详细单位
        tooltip: {
            trigger: 'axis',
            axisPointer: { type: 'shadow' },
            // 格式化： {b}是国家名, {c}是数值
            formatter: function (params) {
                var tar = params[0];
                return tar.name + '<br/>' +
                    '<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:' + tar.color.colorStops[0].color + ';"></span>' +
                    tar.value + ' 十亿千瓦时';
            }
        },
        grid: {
            left: '3%',
            right: '6%', //稍微留宽一点给右侧标签
            bottom: '3%',
            containLabel: true
        },
        // [修改点3] X轴：明确轴标签名称
        xAxis: {
            type: 'value',
            name: '十亿千瓦时', // 轴名称
            nameLocation: 'end',
            nameTextStyle: {
                padding: [0, 0, 0, 10], // 微调位置
                fontWeight: 'bold'
            },
            boundaryGap: [0, 0.01]
        },
        yAxis: {
            type: 'category',
            data: countries,
            inverse: true, // 倒序，Top1 在最上面
            axisLabel: {
                fontWeight: 'bold',
                fontSize: 13
            }
        },
        series: [
            {
                name: 'Net Consumption',
                type: 'bar',
                data: values,
                itemStyle: {
                    // 维持蓝紫色渐变，体现科技/能源感
                    color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                        { offset: 0, color: '#2b5876' },
                        { offset: 1, color: '#4e4376' }
                    ]),
                    borderRadius: [0, 5, 5, 0]
                },
                barWidth: '60%',
                // [修改点4] 柱状图右侧标签
                label: {
                    show: true,
                    position: 'right',
                    valueAnimation: true,
                    fontWeight: 'bold',
                    // 这里一般不加中文单位，以免显得拥挤，只显示数值即可
                    // 如果必须加，可以用 formatter: '{c} '
                    formatter: '{c}'
                }
            }
        ]
    };

    if (option && typeof option === 'object') {
        myChart.setOption(option);
    }

    window.addEventListener('resize', myChart.resize);
</script>
</body>
</html>
